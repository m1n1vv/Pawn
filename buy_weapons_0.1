#define MAX_WEAPONS_NAME 20
#define DIALOG_WEAPONS_ID 18498
static mn_weaponid[MAX_PLAYERS char];
static mn_weap_name[MAX_WEAPONS_NAME];
static mn_caliber[MAX_WEAPONS_NAME];
static mn_ammunition[MAX_PLAYERS char];
static mn_shooting_range[MAX_WEAPONS_NAME+10];
static mn_price[MAX_PLAYERS];
stock BuyWeapons(playerid, weaponid)
{
    mn_weaponid{playerid} = weaponid; 
    PlayerWeapon(playerid);
    SendClientMessage(playerid, -1, "1");
    static const str[] = "Оружие: \t\t\t%s\n\nКалибр: \t\t\t%s\nПатронов в обойме: \t\t%i\nДальность стрельбы: \t\t%s\nЦена: \t\t\t\t$%i";
    new string[sizeof str+MAX_WEAPONS_NAME*3+10+2+5-(7+6+5+5+6)];
    format(string, sizeof string, str, mn_weap_name, mn_caliber, mn_ammunition{playerid}, mn_shooting_range, mn_price[playerid]);
    ShowPlayerDialog(playerid, DIALOG_WEAPONS_ID, DIALOG_STYLE_MSGBOX, "Покупка оружия", string, "Купить", "Закрыть");
    return 1;
}
public OnDialogResponse(playerid, dialogid, response, listitem, inputtext[])
{
    if(dialogid == DIALOG_WEAPONS_ID)
    {
        if(response)
        {
            if(pInfo[playerid][pExMoney] < mn_price[playerid]) return SendClientMessage(playerid, 0xAA3333AA, !"У Вас недостаточно средств");
            pInfo[playerid][pExMoney] -= mn_price[playerid];
            GivePlayerWeapon(playerid, mn_weaponid{playerid}, mn_ammunition{playerid});
            SendClientMessage(playerid, 0x33AA33AA, !"Вы успешно совершили покупку");
            return 1;
        }
        else
        {
            SendClientMessage(playerid, 0xAA3333AA, !"Покупка отклонена");
            mn_weaponid{playerid} = 0;
            mn_ammunition{playerid} = 0;
            mn_price[playerid] = 0;
            return 1;
        }
    }
#if defined mn_OnDialogResponse
    return mn_OnDialogResponse(playerid, dialogid, response, listitem, inputtext);
#endif
}
#if defined _ALS_OnDialogResponse
    #undef OnDialogResponse
#else
    #define _ALS_OnDialogResponse
#endif
#define OnDialogResponse mn_OnDialogResponse
#if defined mn_OnDialogResponse
forward mn_OnDialogResponse(playerid, dialogid, response, listitem, inputtext[]);
#endif
public OnPlayerDisconnect(playerid, reason)
{
    mn_weaponid{playerid} = 0;
    mn_ammunition{playerid} = 0;
    mn_price[playerid] = 0;
#if defined mn_OnPlayerDisconnect
    mn_OnPlayerDisconnect(playerid, reason);
#endif
    return 1;
}
#if defined _ALS_OnPlayerDisconnect
    #undef OnPlayerDisconnect
#else
    #define _ALS_OnPlayerDisconnect
#endif
#define OnPlayerDisconnect mn_OnPlayerDisconnect
#if defined mn_OnPlayerDisconnect
forward mn_OnPlayerDisconnect(playerid, reason);
#endif
